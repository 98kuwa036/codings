# 在庫管理・注文管理システム

Excel VBAベースの在庫管理および注文管理システムです。

## 機能概要

- **マスター設定管理**: 物品の基本情報と発注ルールを管理
- **CSVインポート**: 棚卸データ・入出庫履歴のインポート
- **在庫計算**: 現在庫の自動計算
- **発注判定**: 発注点に基づく自動発注判定
- **発注数計算**: 完品単位・最小単位を考慮した推奨発注数の計算
- **レポート出力**: 発注リストのCSV出力

## セットアップ

### 1. VBAモジュールのインポート

1. Excelで新しいブックを作成
2. `Alt + F11` でVBAエディタを開く
3. 「ファイル」→「ファイルのインポート」
4. `InventoryManagement.bas` を選択

### 2. システム初期化

VBAエディタまたはマクロダイアログから実行：
```
InitializeSystem
```

これにより以下のシートが自動作成されます：
- マスター設定
- 棚卸データ
- 入出庫履歴
- 発注管理
- ダッシュボード

## 使用方法

### マスター設定

「マスター設定」シートに物品情報を入力：

| 列 | 項目 | 説明 |
|----|------|------|
| A | 管理番号 | 物品の識別番号 |
| B | 物品名 | 物品の名称 |
| C | 発注点 | この数量以下で発注アラート |
| D | 最小単位 | 端数処理の単位（例：1, 5, 10） |
| E | 完品単位 | 注文時の単位名称（例：箱、本） |
| F | 完品個数 | 1完品あたりの最小単位数 |
| G | 現在庫 | 自動計算 |
| H | 発注要否 | 自動判定 |
| I | 推奨発注数 | 自動計算 |

### CSVインポート

#### 棚卸データのインポート
```
ImportInventoryCSV
```
- ファイル形式: 日付, 品名, 数量（ヘッダーなし）

#### 入出庫履歴のインポート
```
ImportTransactionCSV
```
- ファイル形式: タイムスタンプ, 記録日, 種別, 記録者, 品名, 個数（ヘッダーあり）

### 在庫計算・発注判定

#### 個別実行
```vba
CalculateCurrentInventory  ' 現在庫を計算
CheckReorderPoints         ' 発注判定
UpdateDashboard           ' ダッシュボード更新
```

#### 一括実行
```
RunAllProcesses
```

### 発注管理

#### 発注リスト生成
```
GenerateOrderList
```
「要発注」の品目を「発注管理」シートに追加

#### 発注レポート出力
```
ExportOrderReport
```
発注必要品目をCSVファイルで出力

### ユーティリティ

#### マスター自動生成
```
GenerateMasterFromInventory
```
棚卸データから物品マスターを自動生成（発注点等は後で設定）

## 計算ロジック

### 現在庫計算
```
現在庫 = 棚卸数量 + 入庫合計 - 出庫合計
```

### 推奨発注数計算
```
不足数 = 発注点 - 現在庫 + 発注点（発注点の2倍まで補充）
発注数 = 不足数を完品個数で切り上げ → 最小単位で切り上げ
```

## ファイル構成

```
Inventry-Management/
├── InventoryManagement.bas  # VBAモジュール
├── README.md                # このファイル
├── 入出庫_2025-10.csv       # サンプル入出庫データ
└── 棚卸_2025-11-12 (1).csv  # サンプル棚卸データ
```

## 注意事項

- CSVファイルは UTF-8 または Shift-JIS で保存してください
- マクロを有効にしてExcelを開いてください
- 棚卸データをインポートすると既存データは上書きされます
- 入出庫履歴は追記されます

## 今後の拡張案

- [ ] 棚卸日以降の入出庫のみ計算する機能
- [ ] 複数倉庫対応
- [ ] 発注履歴のトラッキング
- [ ] 使用量予測に基づく発注点自動調整
- [ ] バーコード/QRコード連携
