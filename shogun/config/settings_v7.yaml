# Shogun System v7.0 Configuration
# "ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚ˆã‚Šè³ª" - Quality over Speed

version: "7.0"
system_name: "å°†è»ã‚·ã‚¹ãƒ†ãƒ  v7.0"
design_philosophy: "ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚ˆã‚Šè³ªã®è¿½æ±‚"

# Core Architecture Settings
architecture:
  shogun:
    model: "claude-3-opus-20240229"  # Latest Opus model for strategic decisions
    role: "ç·å¤§å°† - æˆ¦ç•¥åˆ¤æ–­ãƒ»æœ€çµ‚æ±ºè£"
    usage: "Strategicç´šã‚¿ã‚¹ã‚¯ã®ã¿ (æœˆ5å›ç¨‹åº¦)"
    cost_per_call: 24  # JPY
    
  karo:
    model: "claude-3-5-sonnet-20250106"  # Latest Sonnet model for complex tasks
    role: "å‚è¬€ - Complexç´šä½œæ¥­å‰²æŒ¯ã‚Š"
    usage: "Complexç´šã‚¿ã‚¹ã‚¯ (æœˆ10-20å›)"
    cost_per_call: 5   # JPY (Pro CLI â†’ API fallback)
    
  taisho_japanese:
    model: "cyberagent/DeepSeek-R1-Distill-Qwen-14B-Japanese"
    role: "ä¾å¤§å°† - è¨­è¨ˆãƒ»æ¨è«–ãƒ»ç›£æŸ»"
    url: "http://192.168.1.11:11434"
    usage: "å…¨ãƒ¬ãƒ™ãƒ«å¯¾å¿œãƒ»ãƒ­ãƒ¼ã‚«ãƒ«æ¨è«–"
    cost_per_call: 0   # JPY
    features:
      - "æ—¥æœ¬èªãƒšãƒ©ãƒšãƒ© ğŸŒŸ"
      - "<think>ã«ã‚ˆã‚‹æ·±ã„æ¨è«–"
      - "CyberAgentæœ€é©åŒ–"
      - "60ç§’ã˜ã£ãã‚Šæ€è€ƒ = é«˜å“è³ªã®æºæ³‰"
    
  ashigaru:
    count: 9  # 8 traditional + 1 Groq recorder
    traditional:
      1: "filesystem"
      2: "github" 
      3: "fetch"
      4: "memory"
      5: "postgres"
      6: "puppeteer"
      7: "brave-search"
      8: "slack"
    groq_recorder:
      9: "groq_recorder"
      model: "llama-3.3-70b-versatile"
      role: "è¨˜éŒ²ä¿‚ãƒ»60æ—¥è¦ç´„ãƒ»Notionçµ±åˆ"
      cost_per_call: 0  # JPY (Free tier)

# Pro CLI First Strategy (v7.0 Key Feature)
pro_cli_strategy:
  enabled: true
  primary: "claude-cli"  # Proç‰ˆCLI (FREE)
  fallback: "anthropic-api"  # API (PAID)
  fallback_triggers:
    - "rate_limit"
    - "cli_error"
    - "pro_quota_exceeded"

# Deployment Modes
deployment_modes:
  battalion:  # å¤§éšŠãƒ¢ãƒ¼ãƒ‰ (ãƒ•ãƒ«è£…å‚™)
    agents: ["shogun", "karo", "taisho_japanese", "ashigaru_all"]
    usage: "å…¨ãƒ¬ãƒ™ãƒ«å¯¾å¿œãƒ»æœ€é«˜å“è³ª"
    cost_range: "Â¥0-24/ã‚¿ã‚¹ã‚¯"
    
  company:    # ä¸­éšŠãƒ¢ãƒ¼ãƒ‰ (ã‚³ã‚¹ãƒˆå„ªå…ˆ)
    agents: ["taisho_japanese", "ashigaru_1-8", "groq_recorder"]
    usage: "Simple/Mediumå°‚ç”¨ãƒ»çµŒæ¸ˆçš„"
    cost: "Â¥0"
    limitations:
      - "Complex/Strategicä¸å¯"
      - "æœ€æ–°æŠ€è¡“(2025å¹´2æœˆä»¥é™)å›°é›£" 
      - "10+ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†ä¸å¯"
      
  platoon:    # å°éšŠãƒ¢ãƒ¼ãƒ‰ (éŸ³å£°ç‰¹åŒ–) ğŸŒŸNEWğŸŒŸ
    agents: ["taisho_japanese", "selected_ashigaru"]
    usage: "HA OSéŸ³å£°ãƒ»è¶…è»½é‡"
    cost: "Â¥0"
    response_time: "30-60ç§’"
    configurations:
      voice_query:
        max_ashigaru: 2
        response_time_target: 30
        use_cases: ["I2Sè¨­å®šã¯ï¼Ÿ", "éå»Issueï¼Ÿ"]
      quick_info:
        max_ashigaru: 1
        response_time_target: 15
        use_cases: ["ç°¡å˜ãªæƒ…å ±ç¢ºèª"]
      file_check:
        max_ashigaru: 1
        response_time_target: 10
        use_cases: ["ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèªã®ã¿"]

# Japanese R1 Configuration (v7.0 Enhancement)
taisho_japanese:
  url: "http://192.168.1.11:11434"
  model_path: "/opt/models/deepseek-r1-japanese-int8"
  optimization: "OpenVINO INT8"
  features:
    japanese_native: true
    think_tags: true
    deep_reasoning: true
    cyberagent_tuned: true
  performance:
    target_speed: "7.2 tok/s"
    thinking_time: "60ç§’ (å“è³ªã®ãŸã‚)"
    memory_usage: "20GB"
    cpu_cores: 6

# Groq Configuration (9th Ashigaru)
groq:
  model: "llama-3.3-70b-versatile"
  daily_quota: 14400  # Free tier
  speed: "300-500 tok/s"
  role: "è¨˜éŒ²ä¿‚ãƒ»è¦ç´„ãƒ»ãƒŠãƒ¬ãƒƒã‚¸è“„ç©"
  features:
    real_time_recording: true
    sixty_day_summary: true
    family_precepts_extraction: true
    notion_integration: true
  usage_tracking:
    path: "/var/log/shogun/groq/usage.json"
    reset_schedule: "0 0 * * *"  # Daily at midnight

# Notion Integration (v7.0 NEW)
notion:
  database_id: "${NOTION_DATABASE_ID}"
  token: "${NOTION_TOKEN}"
  auto_summary_days: 60
  entry_types:
    - "60æ—¥è¦ç´„"
    - "å®¶è¨“"
    - "çŸ¥è­˜"
    - "ã‚¨ãƒ©ãƒ¼å¯¾å¿œ"
  automation:
    summary_schedule: "0 3 * * *"  # Daily at 3 AM
    precepts_extraction: true
    search_indexing: true

# Slack Integration (11 Bots) ğŸŒŸEnhancedğŸŒŸ
slack:
  bots:
    main:
      shogun_bot: "${SLACK_TOKEN_SHOGUN}"        # å°†è» (å¤§éšŠãƒ¢ãƒ¼ãƒ‰)
      shogun_bot_light: "${SLACK_TOKEN_LIGHT}"   # ä¸­éšŠãƒ¢ãƒ¼ãƒ‰å°‚ç”¨
    agents:
      karo_bot: "${SLACK_TOKEN_KARO}"             # å®¶è€
      taisho_bot: "${SLACK_TOKEN_TAISHO}"         # ä¾å¤§å°†
    ashigaru:
      ashigaru_1_bot: "${SLACK_TOKEN_ASHIGARU_1}" # filesystem
      ashigaru_2_bot: "${SLACK_TOKEN_ASHIGARU_2}" # github
      ashigaru_3_bot: "${SLACK_TOKEN_ASHIGARU_3}" # fetch
      ashigaru_4_bot: "${SLACK_TOKEN_ASHIGARU_4}" # memory
      ashigaru_5_bot: "${SLACK_TOKEN_ASHIGARU_5}" # postgres
      ashigaru_6_bot: "${SLACK_TOKEN_ASHIGARU_6}" # puppeteer
      ashigaru_7_bot: "${SLACK_TOKEN_ASHIGARU_7}" # brave-search
      ashigaru_8_bot: "${SLACK_TOKEN_ASHIGARU_8}" # slack
      ashigaru_9_bot: "${SLACK_TOKEN_ASHIGARU_9}" # groq_recorder

# Repository Management
repo:
  local_base: "/home/claude"
  sync_interval_minutes: 5
  auto_sync_script: "/home/claude/auto-sync.sh"
  
# Hardware Configuration
hardware:
  honmaru:  # CT 100 - æœ¬é™£
    ip: "192.168.1.10"
    ram: "2GB"
    cpu: "2 cores"
    role: "ã‚¿ã‚¹ã‚¯ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»MCPç®¡ç†ãƒ»Slack Bot"
    
  taisho:   # CT 101 - ä¾å¤§å°†å°‚ç”¨
    ip: "192.168.1.11"
    ram: "20GB"
    cpu: "6 cores (host type, NUMA enabled)"
    role: "R1æ¨è«–å°‚ç”¨"
    optimization:
      hugepages: "10240 (20GB)"
      numa: true
      ballooning: false
      
  ha_os:    # Raspberry Pi 4B
    ip: "192.168.1.20"
    ram: "8GB"
    role: "éŸ³å£°ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆãƒ»å°éšŠãƒ¢ãƒ¼ãƒ‰ãƒˆãƒªã‚¬ãƒ¼"

# Cost Analysis (v7.0 Optimizations)
cost_analysis:
  monthly_estimate:
    fixed_costs:
      claude_pro: 3000      # JPY
      server_power: 800     # JPY 24hç¨¼åƒ
      total_fixed: 3800     # JPY
      
    variable_costs:
      api_usage: 135        # JPY (å¤§å¹…å‰Šæ¸›)
      contingency: 15       # JPY
      total_variable: 150   # JPY
      
    total_monthly: 3950     # JPY
    
  comparison:
    vs_v5: "-49%"           # Â¥7,800 â†’ Â¥3,950
    vs_opus_only: "-84%"    # Â¥24,000 â†’ Â¥3,950
    vs_claude_code: "-49%"  # Â¥7,701 â†’ Â¥3,950
    
  optimization_sources:
    - "Pro CLI first strategy (93% free usage)"
    - "Japanese R1 local inference"
    - "Groq free tier utilization"
    - "Reduced Opus usage (Strategic only)"

# Quality Metrics (v7.0 Achievements)
quality:
  target_score: 95.2      # vs Claude Code 85.8
  improvements:
    simple_quality: 90    # vs 94 (acceptable trade-off)
    complex_quality: 95   # vs 91 (improvement)
    strategic_quality: 97 # vs 86 (major improvement)
    knowledge_recording: 98 # vs 70 (massive improvement)
    security: 96          # vs 88 (improvement)
    
  philosophy: "ã‚¹ãƒ”ãƒ¼ãƒ‰ã‚ˆã‚Šè³ª"
  key_factors:
    - "R1ã®æ·±ã„æ€è€ƒ (60ç§’ = ã˜ã£ãã‚Šè€ƒãˆã‚‹)"
    - "å®¶è€(Opus)ã®æˆ¦ç•¥åˆ¤æ–­"
    - "9ç•ªè¶³è»½ã®å®Œå…¨è¨˜éŒ²"
    - "Notionè‡ªå‹•ãƒŠãƒ¬ãƒƒã‚¸è“„ç©"

# System Monitoring
monitoring:
  dashboard_update_interval: 30  # seconds
  health_check_interval: 60     # seconds
  log_retention_days: 90
  metrics_collection: true
  
# Logging Configuration
logging:
  level: "INFO"
  format: "[%(asctime)s] %(levelname)s [%(name)s] %(message)s"
  japanese_support: true
  files:
    shogun: "/var/log/shogun/shogun.log"
    groq: "/var/log/shogun/groq.log"
    notion: "/var/log/shogun/notion.log"
    r1: "/var/log/shogun/japanese_r1.log"

# Environment Variables Required
required_env_vars:
  - "ANTHROPIC_API_KEY"        # Claude API (fallback)
  - "GROQ_API_KEY"             # 9ç•ªè¶³è»½
  - "NOTION_TOKEN"             # Knowledge management
  - "NOTION_DATABASE_ID"       # Knowledge database
  - "GITHUB_TOKEN"             # 2ç•ªè¶³è»½
  - "BRAVE_API_KEY"            # 7ç•ªè¶³è»½
  # Slack tokens (11 bots)
  - "SLACK_TOKEN_SHOGUN"
  - "SLACK_TOKEN_LIGHT"
  - "SLACK_TOKEN_KARO"
  - "SLACK_TOKEN_TAISHO"
  - "SLACK_TOKEN_ASHIGARU_1"
  - "SLACK_TOKEN_ASHIGARU_2"
  - "SLACK_TOKEN_ASHIGARU_3"
  - "SLACK_TOKEN_ASHIGARU_4"
  - "SLACK_TOKEN_ASHIGARU_5"
  - "SLACK_TOKEN_ASHIGARU_6"
  - "SLACK_TOKEN_ASHIGARU_7"
  - "SLACK_TOKEN_ASHIGARU_8"
  - "SLACK_TOKEN_ASHIGARU_9"

# Error Handling & Resilience Configuration
error_handling:
  retry_policy:
    max_attempts: 3
    backoff_strategy: "exponential"
    base_delay: 1.0  # seconds
    max_delay: 30.0  # seconds
    jitter: true
    
  timeout_settings:
    api_request: 60     # seconds
    local_r1: 120      # seconds (deep thinking allowed)
    groq_request: 30   # seconds
    notion_sync: 45    # seconds
    git_operations: 30 # seconds
    
  fallback_behavior:
    api_failure: "local_r1"        # Fallback to local R1 if API fails
    r1_failure: "simplified_response"  # Provide basic response if R1 unavailable
    groq_failure: "skip_recording"     # Continue without recording if Groq fails
    notion_failure: "local_cache"      # Cache locally if Notion unavailable
    
  circuit_breaker:
    enabled: true
    failure_threshold: 5
    recovery_timeout: 300  # seconds
    half_open_requests: 3
    
  health_monitoring:
    interval: 60       # seconds
    endpoints:
      - "taisho_r1"
      - "groq_api" 
      - "notion_api"
      - "anthropic_api"
    alert_thresholds:
      consecutive_failures: 3
      response_time_ms: 10000

# Feature Flags
features:
  japanese_r1: true
  groq_recorder: true
  notion_integration: true
  platoon_mode: true
  pro_cli_first: true
  eleven_slack_bots: true
  sixty_day_summary: true
  family_precepts: true
  real_time_recording: true
  enhanced_error_handling: true

# Success Metrics
success_criteria:
  quality_score: ">95.0"
  monthly_cost: "<Â¥4,000"
  knowledge_accumulation: ">90% sessions recorded"
  pro_cli_success_rate: ">90%"
  japanese_r1_availability: ">99%"
  response_time_platoon: "<60s"
  notion_sync_success: ">95%"

# Version History
changelog:
  v5_to_v7_improvements:
    - "claude-cliç™ºè¦‹ã¨Proå„ªå…ˆæˆ¦ç•¥"
    - "æ—¥æœ¬èªR1ãƒ¢ãƒ‡ãƒ«æ¡ç”¨"
    - "çµ„ç¹”æ§‹é€ ã®æ­£ç¢ºåŒ–ï¼ˆå°†è»ãŒãƒˆãƒƒãƒ—ï¼‰"
    - "å®Ÿè£…å±¤ã®æ˜ç¢ºåŒ–ï¼ˆGroqè¶³è»½çµ„ï¼‰"
    - "å°éšŠãƒ¢ãƒ¼ãƒ‰è¿½åŠ "
    - "Notionçµ±åˆ"
    - "60æ—¥è¦ç´„è‡ªå‹•åŒ–"
    - "ã‚³ã‚¹ãƒˆ49%å‰Šæ¸›é”æˆ"