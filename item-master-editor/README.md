# 物品マスター編集ツール

在庫管理システム（inventry-data）で使用する物品マスター情報を編集するためのWebアプリケーションです。

## 概要

このツールを使用して、物品の以下の情報を編集できます：

- **最小単位**: 在庫の最小単位（例: 本、個、枚など）
- **荷姿単位**: 荷姿の単位（例: ダース、箱、ケースなど）
- **荷姿入数**: 荷姿1単位に含まれる最小単位の数（例: 12本、24個など）
- **発注点**: 在庫がこの数量を下回ったら発注が必要な基準値（例: 24本など）

## 機能

- 📋 物品マスター一覧の表示
- ✏️ 最小単位、荷姿単位、荷姿入数、発注点の編集
- 💾 一括保存機能
- 🔄 データ再読み込み
- 📱 レスポンシブデザイン（PC・スマホ対応）

## 使用方法

### 1. Google Apps Scriptへのデプロイ

1. Google Apps Scriptプロジェクトを作成
2. `Code.gs` と `index.html` をプロジェクトに追加
3. Webアプリとしてデプロイ
   - 実行ユーザー: 自分
   - アクセス権限: 自分のみ or 組織内のユーザー

### 2. 設定

`Code.gs` の `CONFIG` セクションで以下を設定：

```javascript
const CONFIG = {
  SOURCE_ID: '13IsEoCgT9v0-J5TAaCAb_vZyyDMjzv_yXaI5khqvFnY', // スプレッドシートID
  MASTER_SHEET_NAME: 'マスター',  // シート名
  CACHE_KEY: 'item_master_editor_v1',
  CACHE_DURATION: 300  // キャッシュ時間（秒）
};
```

### 3. データ編集

1. Webアプリを開く
2. 物品一覧が表示されます
3. 各物品の「最小単位」「荷姿単位」「荷姿入数」「発注点」を入力
4. 「すべて保存」ボタンをクリック

### 入力例

| 物品名 | 最小単位 | 荷姿単位 | 荷姿入数 | 発注点 |
|--------|----------|----------|----------|--------|
| ビール | 本 | ダース | 12 | 24 |
| コピー用紙 | 枚 | 箱 | 500 | 1000 |
| 缶詰 | 個 | ケース | 24 | 48 |

## スプレッドシート構造

参照するスプレッドシートの構造：

- **A列**: 行番号
- **B列**: 物品名（必須）
- **C列**: 最小単位
- **D列**: 荷姿単位
- **E列**: 荷姿入数
- **F列**: 発注点

## 注意事項

- データを保存すると、在庫管理システム（inventry-data）のキャッシュも自動的にクリアされます
- 物品名（B列）が空の行や、`---...---` 形式の区切り線は無視されます
- 荷姿入数は数値で入力してください

## データ移行機能

### 発注点データのコピー

H列とI列に発注点データがある場合、以下のスクリプトで一括コピーできます：

```javascript
copyReorderPointFromHI()
```

**処理内容：**
1. B列（物品名）の各値について、H列全体から同じ値を検索
2. H列で一致した行のI列の値を取得
3. その値をB列の行のF列（発注点）にコピー
4. 行番号が異なっていても一致すればコピー

**使い方：**
1. Google Apps Scriptエディタを開く
2. スクリプトエディタで `copyReorderPointFromHI` を実行
3. ログで処理結果を確認

**例：**
| 行 | B列(物品名) | F列(発注点) | H列(物品名) | I列(発注点) | 処理後のF列 |
|----|------------|------------|------------|------------|------------|
| 2 | ビール | (空) | - | - | 24 |
| 3 | コーラ | 10 | - | - | 20 |
| 4 | お茶 | 15 | - | - | 15 (変更なし) |
| 5 | - | - | ビール | 24 | - |
| 8 | - | - | コーラ | 20 | - |
| 10 | - | - | 水 | 30 | - |

※ B2「ビール」はH5「ビール」と一致 → I5の24をF2にコピー
※ B3「コーラ」はH8「コーラ」と一致 → I8の20をF3にコピー
※ B4「お茶」はH列に存在しない → F4は変更なし

## 連携システム

このツールで編集したデータは、以下のシステムで使用されます：

- **inventry-data**: 在庫管理システム（荷姿単位での入力が可能になります）

## トラブルシューティング

### データが表示されない

- スプレッドシートIDが正しいか確認
- シート名「マスター」が存在するか確認
- Google Apps Scriptのアクセス権限を確認

### 保存できない

- ブラウザのコンソールでエラーを確認
- スプレッドシートへの書き込み権限があるか確認

## 開発情報

- **言語**: Google Apps Script (JavaScript)
- **フロントエンド**: HTML, CSS, JavaScript
- **バックエンド**: Google Apps Script
- **データソース**: Google Spreadsheet

## 更新履歴

| 日付 | バージョン | 変更内容 |
|------|------------|----------|
| 2025-12-02 | 1.2.0 | 発注点データコピー機能を追加 |
| 2025-12-01 | 1.1.0 | 発注点機能を追加 |
| 2025-11-30 | 1.0.0 | 初版リリース |
